<template>
    <div class="landing">
        <section class="heroBox">
            <div class="container">
                        
                        <p class="supheadline">Du bist Grafikdesigner oder Mediengestalter?</p>
                        <img class="imgRight" src="https://strapi.digimedialoop.de/uploads/crazy_Webdesign_46716a1640.png" alt="programmierung für mediendesigner">
                        <h1>Dein Design verdient eine perfekte Umsetzung ohne Kompromisse!</h1>
                        <h2>Du hast ein geniales Design im Kopf &ndash; doch fühlst dich von deinem Programm oder deinem Entwickler immer wieder ausgebremst?</h2>
                
                <h3>Jou! Das kann richtig frustrierend sein - muss es aber nicht!</h3>
                <p>Denn ich bin kein "Klicki-Bunti-klick-mich-zusammen"-Webentwickler - ich kann wirklich programmieren!</p>
                    <p>Somit bin ich auch nicht auf starre Templates oder eingeschränkte Tools angewiesen. 
                    Egal wie kreativ, individuell oder ausgefallen deine Idee ist - ich finde einen Weg, 
                    sie genau so umzusetzen, damit Du und Dein Kunde zufrieden seid!</p>
                    <button class="pinkBtn">Jetzt Zusammenarbeit starten</button>
                        
            </div>
        </section>
        
        <section class="cooperation">
            <div class="container">
                <h2>Mehr Freiheit für dein Design</h2>
                <ul>
                    <li><b>Pixelgenaue Umsetzung</b> <br>Ich setze dein Design so nah wie möglich am Original um und achte dabei auf jedes Detail.</li>
                    <li><b>Individuelle Lösungen & komplexe Funktionen</b> <br>Egal ob API-Anbindung, dynamische Inhalte oder interaktive Features – ich finde eine Lösung für fast alles.</li>
                    <li><b>Performance & Ladegeschwindigkeit</b> <br>Schnelle & schlanke Webseiten, die auf jedem Gerät reibungslos laufen.</li>
                    <li><b>Tool-übergreifende Kompetenz</b> <br>Kein WordPress-Zwang – ich nutze die beste Lösung für dein Projekt, unabhängig vom System.</li>
                </ul>
                <p><b>Du bleibst der kreative Kopf!</b><br>
                Ich sorge dafür, dass dein Design genauso im Web erscheint, wie du es geplant hast – mit Top-Performance & perfekter technischer Umsetzung.</p>
            </div>
            
        </section>
        <section class="deviceCheck">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <p class="supheadline">Responsive Check</p>
                        <h2>Wie sieht deine Webseite auf den verschiedenen Devices aus?</h2>
                        <h3>Probiers einfach aus!</h3>
                        <input type="text" placeholder="https://www.deinewebseite.de" v-model="weblink" @keyup.enter="updateIframe">
                       
                    </div>
                    <div class="col-md-6">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 450" >
                            <defs>
                                <clipPath id="_clipPath_mz11Urxh3q4HMztuYrKSFIZi2059ENKc">
                                    <rect width="500" height="450"/>
                                </clipPath>
                            </defs>
                            <g clip-path="url(#_clipPath_mz11Urxh3q4HMztuYrKSFIZi2059ENKc)">
                                <linearGradient id="_lgradient_0" x1="0.49993063593634346" y1="1.0075692569857018" x2="0.5082382316706063" y2="0.6847598402209258" gradientTransform="matrix(175.952,0,0,65.207,161.506,313.536)" gradientUnits="userSpaceOnUse">
                                    <stop offset="0.8699999999999999%" stop-opacity="1" style="stop-color:rgb(209,209,209)"/>
                                    <stop offset="47.83%" stop-opacity="1" style="stop-color:rgb(232,232,232)"/>
                                    <stop offset="100%" stop-opacity="1" style="stop-color:rgb(209,209,209)"/>
                                </linearGradient>
                                <path d=" M 305.374 354.758 L 305.374 313.536 L 193.592 313.536 L 193.592 353.951 L 161.506 378.743 L 249.483 377.869 L 337.458 378.743 L 305.374 354.758 Z " fill="url(#_lgradient_0)" vector-effect="non-scaling-stroke" stroke-width="1" stroke="rgb(217,215,215)" stroke-opacity="100" stroke-linejoin="miter" stroke-linecap="square" stroke-miterlimit="3"/>
                                <linearGradient id="_lgradient_1" x1="0.0000010284238562002779" y1="0.499981826442526" x2="0.9999991252331814" y2="0.499981826442526" gradientTransform="matrix(443,0,0,43.47,28.5,275.242)" gradientUnits="userSpaceOnUse">
                                    <stop offset="1.7399999999999998%" stop-opacity="1" style="stop-color:rgb(209,209,209)"/>
                                    <stop offset="100%" stop-opacity="1" style="stop-color:rgb(235,235,235)"/>
                                </linearGradient>
                                <path d=" M 34.273 275.242 L 465.964 275.242 C 469.02 275.242 471.5 277.728 471.5 280.79 L 471.5 297.862 C 471.5 309.369 462.177 318.712 450.697 318.712 L 49.302 318.712 C 37.822 318.712 28.5 309.369 28.5 297.862 L 28.5 281.027 C 28.5 277.834 31.087 275.242 34.273 275.242 Z " fill="url(#_lgradient_1)" vector-effect="non-scaling-stroke" stroke-width="1" stroke="rgb(217,215,215)" stroke-opacity="100" stroke-linejoin="miter" stroke-linecap="square" stroke-miterlimit="3"/>
                                <path d=" M 472.012 254.78 L 472.012 51.832 C 472.012 40.335 462.945 31 451.776 31 L 48.223 31 C 37.055 31 27.988 40.335 27.988 51.832 L 27.988 254.78 L 27.988 255.259 L 27.988 282.486 L 472.012 282.486 L 472.012 255.259 L 472.012 254.78 Z  M 45.583 46.984 L 454.416 46.984 L 454.416 268.633 L 45.583 268.633 L 45.583 46.984 Z " fill-rule="evenodd" fill="rgb(55,55,55)"/>
                                <path d="M 73.451 74.227 L 133.299 74.227 L 133.299 134.075 L 73.451 134.075 L 73.451 74.227 Z" style="stroke:none;fill:#F0F0F0;stroke-miterlimit:10;"/>
                                <linearGradient id="_lgradient_2" x1="-0.0000019194307706443814" y1="0.5000543177381012" x2="0.9999980747113533" y2="0.5000543177381012" gradientTransform="matrix(306.503,0,0,9.583,96.179,370.194)" gradientUnits="userSpaceOnUse">
                                    <stop offset="0.8699999999999999%" stop-opacity="1" style="stop-color:rgb(162,162,162)"/>
                                    <stop offset="97.83%" stop-opacity="1" style="stop-color:rgb(232,232,232)"/>
                                </linearGradient>
                                <path d=" M 98.371 370.463 C 102.752 369.979 396.421 370.256 400.595 370.463 C 403.378 370.6 403.378 373.706 400.595 379.777 L 98.371 379.777 C 95.449 373.89 95.449 370.785 98.371 370.463 Z " fill="url(#_lgradient_2)" vector-effect="non-scaling-stroke" stroke-width="1" stroke="rgb(185,185,185)" stroke-opacity="100" stroke-linejoin="miter" stroke-linecap="square" stroke-miterlimit="3"/>
                                <rect x="45.583" y="46.984" width="408.832" height="222.047" transform="matrix(1,0,0,1,0,0)" fill="rgb(0,0,0)"/>
                                <path d=" M 243.844 302.371 C 242.175 299.831 245.066 297.867 247.098 297.222 C 251.729 295.751 255.722 297.863 254.907 301.23 C 253.327 307.756 245.055 304.215 243.844 302.371 Z " fill="rgb(55,55,55)"/>
                                <rect id="deskScreenBlank" x="46" y="47.5" width="409.5" height="221.5" transform="matrix(1,0,0,1,0,0)" fill="rgb(0,0,0)"/>
                                <foreignObject v-if="isValidUrl(weblink)" id="deskScreen" x="46" y="47.5" width="409.5" height="221.5">
                                    <iframe ref="iframeRef" :src="weblink" frameborder="0"></iframe>
                                </foreignObject>                                
                                <path d=" M 82.951 232 L 171.381 232 C 178.346 232 184 237.654 184 244.619 L 184 422.881 C 184 429.846 178.346 435.5 171.381 435.5 L 82.951 435.5 C 75.986 435.5 70.332 429.846 70.332 422.881 L 70.332 244.619 C 70.332 237.654 75.986 232 82.951 232 Z " fill="rgb(55,55,55)"/>
                                <path d="M 84.542 237.86 L 168.958 237.86 C 172.569 237.86 175.5 240.791 175.5 244.401 L 175.5 419.899 C 175.5 423.509 172.569 426.44 168.958 426.44 L 84.542 426.44 C 80.931 426.44 78 423.509 78 419.899 L 78 244.401 C 78 240.791 80.931 237.86 84.542 237.86 Z" style="stroke:none;fill:#000000;stroke-miterlimit:10;"/>
                                <rect id="mobilScreenBlank" x="77.5" y="238" width="99" height="188.5" transform="matrix(1,0,0,1,0,0)" fill="rgb(0,0,0)" fill-opacity="0"/>
                                <!--<foreignObject v-if="isValidUrl(weblink)" id="mobileScreen" x="77.5" y="238" width="99" height="188.5">
                                    <iframe ref="iframeRef" :src="weblink" frameborder="0"></iframe>
                                </foreignObject> -->                               
                                <path d=" M 108.639 232.766 L 145.628 232.766 C 147.689 232.766 149.362 234.439 149.362 236.501 L 149.362 236.666 C 149.362 238.727 147.689 240.401 145.628 240.401 L 108.639 240.401 C 106.578 240.401 104.904 238.727 104.904 236.666 L 104.904 236.501 C 104.904 234.439 106.578 232.766 108.639 232.766 Z " fill="rgb(55,55,55)"/>
                            </g>
                        </svg>

                    </div>
                    
                </div>
            </div>
        </section>
    </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted, nextTick } from "vue";

const weblink = ref("");
const iframeRef = ref(null);
const observer = ref(null);


// Berechnet die exakte Größe des `foreignObject` basierend auf `#deskScreenBlank`
const updateIframeSize = () => {
    nextTick(() => {
        const blankRect = document.getElementById("deskScreenBlank");
        const foreignObject = document.getElementById("deskScreen");

        if (blankRect && foreignObject && iframeRef.value) {
            // Exakte Werte auslesen und Float-Werte setzen (verhindert Subpixel-Rundungen)
            const currentWidth = parseFloat(blankRect.getAttribute("width"));
            const currentHeight = parseFloat(blankRect.getAttribute("height"));

            // Setze `foreignObject` exakt auf `#deskScreenBlank`
            foreignObject.setAttribute("width", currentWidth.toFixed(2));
            foreignObject.setAttribute("height", currentHeight.toFixed(2));

            // Berechne den Skalierungsfaktor für 1400px Breite
            const zoomFactor = currentWidth / 1400;

            // Setze das `iframe` korrekt
            iframeRef.value.style.width = "1400px"; // Fixierte Breite
            iframeRef.value.style.height = "755px"; // Höhe für Scrollbarkeit
            iframeRef.value.style.zoom = zoomFactor; // Zoom-Faktor
            iframeRef.value.style.overflowY = "scroll"; // Scrollen aktivieren
        }
    });
};

// Startet `ResizeObserver`, um live Änderungen zu tracken
const startObserver = () => {
    const blankRect = document.getElementById("deskScreenBlank");
    if (blankRect) {
        observer.value = new ResizeObserver(updateIframeSize);
        observer.value.observe(blankRect);
    }
};

// URL aktualisieren & Größe anpassen
const updateIframe = () => {
    if (!weblink.value.trim()) return;

    weblink.value = ensureValidUrl(weblink.value);

    if (!isValidUrl(weblink.value)) {
        alert("Bitte eine gültige URL eingeben.");
        return;
    }

    updateIframeSize();
};

// Automatisch "https://" hinzufügen, falls nötig
const ensureValidUrl = (url) => {
    if (!url.match(/^https?:\/\//)) {
        return "https://" + url;
    }
    return url;
};

// Prüft, ob die URL gültig ist
const isValidUrl = (url) => {
    try {
        new URL(url);
        return true;
    } catch (_) {
        return false;
    }
};

// Initialisiere `ResizeObserver` beim Mounten
onMounted(() => {
    startObserver();
    updateIframeSize();
});

// Entferne Observer, wenn die Komponente zerstört wird
onUnmounted(() => {
    if (observer.value) observer.value.disconnect();
});
</script>




<style lang="sass">
.landing
    section
        margin: 10vh auto
    h3
        line-height: 150%
        font-size: 1.4rem
    .heroBox
        width: 100%
        h2
            margin-bottom: 1rem
            font-size: 1.4rem
        h3
            font-size: 1.1rem
            font-family: 'Mainfont-Bold'
            margin-bottom: 1rem
        img
            width: 50%
            max-width: 500px
            @media(max-width: $breakPointXL)
                width: 43%
            @media(max-width: $breakPointLG)
                width: 100%
    .cooperation    
        ul
            list-style: none
            padding: 0 0 1rem 1rem
        
            li
                position: relative
                padding-left: 2rem
                font-size: 1rem
                margin-bottom: 1rem
        
                &::before
                    content: "✔"
                    color: $primaryColor
                    font-weight: bold
                    position: absolute
                    font-size: 1.4rem
                    left: 0
        
    img
        width: 100%
        max-width: 300px
        //border-radius: $loopShape
        filter: hue-rotate(310deg) grayscale(.4)
    .supheadline
        color: darken($pink, 0%)
        margin-bottom: -.5rem
    .deviceCheck
        h2
            margin-bottom: .5rem
        input
            width: 100%
            padding: .5rem 1rem
            border: 1px solid lightgrey
            border-radius: 5px
            font-size: 1.2rem
            color: $darkgrey
        #deskScreen
            width: 100%
            height: 100%
            position: relative
            overflow: hidden
    
            iframe
                width: 1400px // Fixierte virtuelle Breite
                height: auto // Automatische Höhe für Scrollen
                border: none
                display: block
                overflow-y: auto // Scrollen aktivieren

</style>